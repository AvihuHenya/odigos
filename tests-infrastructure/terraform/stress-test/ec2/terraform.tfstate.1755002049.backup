{"version":4,"terraform_version":"1.10.5","serial":4,"lineage":"dd09d3a1-d250-56b2-cb48-4e8a4c6db25a","outputs":{"attached_sg_id":{"value":"sg-03ad9237e0de6a325","type":"string"},"grafana_url":{"value":"http://54.198.191.191:3000","type":"string"},"instance_public_ip":{"value":"54.198.191.191","type":"string"}},"resources":[{"mode":"data","type":"aws_ami","name":"amazon_linux","provider":"provider[\"registry.opentofu.org/hashicorp/aws\"]","instances":[{"schema_version":0,"attributes":{"allow_unsafe_filter":null,"architecture":"x86_64","arn":"arn:aws:ec2:us-east-1::image/ami-0e2c86481225d3c51","block_device_mappings":[{"device_name":"/dev/xvda","ebs":{"delete_on_termination":"true","encrypted":"false","iops":"0","snapshot_id":"snap-05a1692e16f3465af","throughput":"0","volume_initialization_rate":"0","volume_size":"8","volume_type":"gp2"},"no_device":"","virtual_name":""}],"boot_mode":"","creation_date":"2025-08-08T20:33:28.000Z","deprecation_time":"2025-11-06T20:33:00.000Z","description":"Amazon Linux 2 AMI 2.0.20250808.1 x86_64 HVM gp2","ena_support":true,"executable_users":null,"filter":[{"name":"name","values":["amzn2-ami-hvm-*-x86_64-gp2"]},{"name":"virtualization-type","values":["hvm"]}],"hypervisor":"xen","id":"ami-0e2c86481225d3c51","image_id":"ami-0e2c86481225d3c51","image_location":"amazon/amzn2-ami-hvm-2.0.20250808.1-x86_64-gp2","image_owner_alias":"amazon","image_type":"machine","imds_support":"","include_deprecated":false,"kernel_id":"","last_launched_time":"","most_recent":true,"name":"amzn2-ami-hvm-2.0.20250808.1-x86_64-gp2","name_regex":null,"owner_id":"137112412989","owners":["137112412989"],"platform":"","platform_details":"Linux/UNIX","product_codes":[],"public":true,"ramdisk_id":"","region":"us-east-1","root_device_name":"/dev/xvda","root_device_type":"ebs","root_snapshot_id":"snap-05a1692e16f3465af","sriov_net_support":"simple","state":"available","state_reason":{"code":"UNSET","message":"UNSET"},"tags":{},"timeouts":null,"tpm_support":"","uefi_data":null,"usage_operation":"RunInstances","virtualization_type":"hvm"},"sensitive_attributes":[]}]},{"mode":"data","type":"aws_subnet","name":"public0","provider":"provider[\"registry.opentofu.org/hashicorp/aws\"]","instances":[{"schema_version":0,"attributes":{"arn":"arn:aws:ec2:us-east-1:061717858829:subnet/subnet-01e1e567d15e30459","assign_ipv6_address_on_creation":false,"availability_zone":"us-east-1a","availability_zone_id":"use1-az6","available_ip_address_count":249,"cidr_block":"10.0.3.0/24","customer_owned_ipv4_pool":"","default_for_az":false,"enable_dns64":false,"enable_lni_at_device_index":0,"enable_resource_name_dns_a_record_on_launch":false,"enable_resource_name_dns_aaaa_record_on_launch":false,"filter":null,"id":"subnet-01e1e567d15e30459","ipv6_cidr_block":"","ipv6_cidr_block_association_id":"","ipv6_native":false,"map_customer_owned_ip_on_launch":false,"map_public_ip_on_launch":false,"outpost_arn":"","owner_id":"061717858829","private_dns_hostname_type_on_launch":"ip-name","region":"us-east-1","state":"available","tags":{"Name":"stress-testing-vpc-public-us-east-1a","kubernetes.io/role/elb":"1"},"timeouts":null,"vpc_id":"vpc-05abbea8c9c36e30c"},"sensitive_attributes":[]}]},{"mode":"data","type":"terraform_remote_state","name":"eks","provider":"provider[\"terraform.io/builtin/terraform\"]","instances":[{"schema_version":0,"attributes":{"backend":"local","config":{"value":{"path":"../terraform.tfstate"},"type":["object",{"path":"string"}]},"defaults":null,"outputs":{"value":{"eks_node_sg_id":"sg-03ad9237e0de6a325","private_subnet_ids":["subnet-048e5bcded6dd20d1","subnet-013cd6c2ed6c886ee"],"public_subnet_ids":["subnet-01e1e567d15e30459","subnet-0ada5f69d5f70d280"],"vpc_id":"vpc-05abbea8c9c36e30c"},"type":["object",{"eks_node_sg_id":"string","private_subnet_ids":["tuple",["string","string"]],"public_subnet_ids":["tuple",["string","string"]],"vpc_id":"string"}]},"workspace":null},"sensitive_attributes":[]}]},{"mode":"managed","type":"aws_ebs_volume","name":"grafana_data","provider":"provider[\"registry.opentofu.org/hashicorp/aws\"]","instances":[{"schema_version":0,"attributes":{"arn":"arn:aws:ec2:us-east-1:061717858829:volume/vol-0e43aeeb064531abc","availability_zone":"us-east-1a","create_time":"2025-08-12T09:59:29Z","encrypted":true,"final_snapshot":false,"id":"vol-0e43aeeb064531abc","iops":3000,"kms_key_id":"arn:aws:kms:us-east-1:061717858829:key/1a1a7f3c-45a5-472e-9ca9-7e9aaf9072ac","multi_attach_enabled":false,"outpost_arn":"","region":"us-east-1","size":20,"snapshot_id":"","tags":{"Name":"grafana-data-volume"},"tags_all":{"Name":"grafana-data-volume"},"throughput":125,"timeouts":null,"type":"gp3","volume_initialization_rate":0},"sensitive_attributes":[],"private":"eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjozMDAwMDAwMDAwMDAsImRlbGV0ZSI6NjAwMDAwMDAwMDAwLCJ1cGRhdGUiOjMwMDAwMDAwMDAwMH19","dependencies":["data.aws_subnet.public0","data.terraform_remote_state.eks"]}]},{"mode":"managed","type":"aws_ebs_volume","name":"prometheus_data","provider":"provider[\"registry.opentofu.org/hashicorp/aws\"]","instances":[{"schema_version":0,"attributes":{"arn":"arn:aws:ec2:us-east-1:061717858829:volume/vol-061ec1d38f00249bc","availability_zone":"us-east-1a","create_time":"2025-08-12T09:59:29Z","encrypted":true,"final_snapshot":false,"id":"vol-061ec1d38f00249bc","iops":3000,"kms_key_id":"arn:aws:kms:us-east-1:061717858829:key/1a1a7f3c-45a5-472e-9ca9-7e9aaf9072ac","multi_attach_enabled":false,"outpost_arn":"","region":"us-east-1","size":50,"snapshot_id":"","tags":{"Name":"prometheus-data-volume"},"tags_all":{"Name":"prometheus-data-volume"},"throughput":125,"timeouts":null,"type":"gp3","volume_initialization_rate":0},"sensitive_attributes":[],"private":"eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjozMDAwMDAwMDAwMDAsImRlbGV0ZSI6NjAwMDAwMDAwMDAwLCJ1cGRhdGUiOjMwMDAwMDAwMDAwMH19","dependencies":["data.aws_subnet.public0","data.terraform_remote_state.eks"]}]},{"mode":"managed","type":"aws_instance","name":"monitoring","provider":"provider[\"registry.opentofu.org/hashicorp/aws\"]","instances":[{"schema_version":2,"attributes":{"ami":"ami-0e2c86481225d3c51","arn":"arn:aws:ec2:us-east-1:061717858829:instance/i-0b80143e25b6c93c6","associate_public_ip_address":true,"availability_zone":"us-east-1a","capacity_reservation_specification":[{"capacity_reservation_preference":"open","capacity_reservation_target":[]}],"cpu_options":[{"amd_sev_snp":"","core_count":1,"threads_per_core":2}],"credit_specification":[],"disable_api_stop":false,"disable_api_termination":false,"ebs_block_device":[{"delete_on_termination":false,"device_name":"/dev/sdf","encrypted":true,"iops":3000,"kms_key_id":"arn:aws:kms:us-east-1:061717858829:key/1a1a7f3c-45a5-472e-9ca9-7e9aaf9072ac","snapshot_id":"","tags":{"Name":"prometheus-data-volume"},"tags_all":{"Name":"prometheus-data-volume"},"throughput":125,"volume_id":"vol-061ec1d38f00249bc","volume_size":50,"volume_type":"gp3"},{"delete_on_termination":false,"device_name":"/dev/sdg","encrypted":true,"iops":3000,"kms_key_id":"arn:aws:kms:us-east-1:061717858829:key/1a1a7f3c-45a5-472e-9ca9-7e9aaf9072ac","snapshot_id":"","tags":{"Name":"grafana-data-volume"},"tags_all":{"Name":"grafana-data-volume"},"throughput":125,"volume_id":"vol-0e43aeeb064531abc","volume_size":20,"volume_type":"gp3"}],"ebs_optimized":false,"enable_primary_ipv6":null,"enclave_options":[{"enabled":false}],"ephemeral_block_device":[],"force_destroy":false,"get_password_data":false,"hibernation":false,"host_id":"","host_resource_group_arn":null,"iam_instance_profile":"","id":"i-0b80143e25b6c93c6","instance_initiated_shutdown_behavior":"stop","instance_lifecycle":"","instance_market_options":[],"instance_state":"running","instance_type":"m6i.large","ipv6_address_count":0,"ipv6_addresses":[],"key_name":"Avihu","launch_template":[],"maintenance_options":[{"auto_recovery":"default"}],"metadata_options":[{"http_endpoint":"enabled","http_protocol_ipv6":"disabled","http_put_response_hop_limit":1,"http_tokens":"optional","instance_metadata_tags":"disabled"}],"monitoring":false,"network_interface":[],"outpost_arn":"","password_data":"","placement_group":"","placement_partition_number":0,"primary_network_interface_id":"eni-03c5f53f18390a9d4","private_dns":"ip-10-0-3-133.ec2.internal","private_dns_name_options":[{"enable_resource_name_dns_a_record":false,"enable_resource_name_dns_aaaa_record":false,"hostname_type":"ip-name"}],"private_ip":"10.0.3.133","public_dns":"ec2-54-198-191-191.compute-1.amazonaws.com","public_ip":"54.198.191.191","region":"us-east-1","root_block_device":[{"delete_on_termination":true,"device_name":"/dev/xvda","encrypted":true,"iops":3000,"kms_key_id":"arn:aws:kms:us-east-1:061717858829:key/1a1a7f3c-45a5-472e-9ca9-7e9aaf9072ac","tags":{},"tags_all":{},"throughput":125,"volume_id":"vol-0c0f65916d176f957","volume_size":100,"volume_type":"gp3"}],"secondary_private_ips":[],"security_groups":[],"source_dest_check":true,"spot_instance_request_id":"","subnet_id":"subnet-01e1e567d15e30459","tags":{"Name":"monitoring-node"},"tags_all":{"Name":"monitoring-node"},"tenancy":"default","timeouts":null,"user_data":null,"user_data_base64":null,"user_data_replace_on_change":false,"volume_tags":null,"vpc_security_group_ids":["sg-03ad9237e0de6a325"]},"sensitive_attributes":[],"private":"eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjo2MDAwMDAwMDAwMDAsImRlbGV0ZSI6MTIwMDAwMDAwMDAwMCwicmVhZCI6OTAwMDAwMDAwMDAwLCJ1cGRhdGUiOjYwMDAwMDAwMDAwMH0sInNjaGVtYV92ZXJzaW9uIjoiMiJ9","dependencies":["data.aws_ami.amazon_linux","data.terraform_remote_state.eks"]}]},{"mode":"managed","type":"aws_security_group_rule","name":"allow_clickhouse_http_from_vpc","provider":"provider[\"registry.opentofu.org/hashicorp/aws\"]","instances":[{"schema_version":2,"attributes":{"cidr_blocks":["10.0.0.0/16"],"description":"VPC to EC2 ClickHouse HTTP","from_port":8123,"id":"sgrule-1747000165","ipv6_cidr_blocks":null,"prefix_list_ids":null,"protocol":"tcp","region":"us-east-1","security_group_id":"sg-03ad9237e0de6a325","security_group_rule_id":"sgr-0aba9b8c6bbb85794","self":false,"source_security_group_id":null,"timeouts":null,"to_port":8123,"type":"ingress"},"sensitive_attributes":[],"private":"eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjozMDAwMDAwMDAwMDB9LCJzY2hlbWFfdmVyc2lvbiI6IjIifQ==","dependencies":["data.terraform_remote_state.eks"]}]},{"mode":"managed","type":"aws_security_group_rule","name":"allow_clickhouse_tcp_from_vpc","provider":"provider[\"registry.opentofu.org/hashicorp/aws\"]","instances":[{"schema_version":2,"attributes":{"cidr_blocks":["10.0.0.0/16"],"description":"VPC to EC2 ClickHouse native","from_port":9000,"id":"sgrule-474026373","ipv6_cidr_blocks":null,"prefix_list_ids":null,"protocol":"tcp","region":"us-east-1","security_group_id":"sg-03ad9237e0de6a325","security_group_rule_id":"sgr-012a1c76a403bc260","self":false,"source_security_group_id":null,"timeouts":null,"to_port":9000,"type":"ingress"},"sensitive_attributes":[],"private":"eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjozMDAwMDAwMDAwMDB9LCJzY2hlbWFfdmVyc2lvbiI6IjIifQ==","dependencies":["data.terraform_remote_state.eks"]}]},{"mode":"managed","type":"aws_security_group_rule","name":"allow_grafana_from_your_ip","provider":"provider[\"registry.opentofu.org/hashicorp/aws\"]","instances":[{"schema_version":2,"attributes":{"cidr_blocks":["212.117.136.162/32"],"description":"Grafana UI to EC2","from_port":3000,"id":"sgrule-63677602","ipv6_cidr_blocks":null,"prefix_list_ids":null,"protocol":"tcp","region":"us-east-1","security_group_id":"sg-03ad9237e0de6a325","security_group_rule_id":"sgr-0e3fb98cda7a2ec83","self":false,"source_security_group_id":null,"timeouts":null,"to_port":3000,"type":"ingress"},"sensitive_attributes":[],"private":"eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjozMDAwMDAwMDAwMDB9LCJzY2hlbWFfdmVyc2lvbiI6IjIifQ==","dependencies":["data.terraform_remote_state.eks"]}]},{"mode":"managed","type":"aws_security_group_rule","name":"allow_prom_ui_from_your_ip","provider":"provider[\"registry.opentofu.org/hashicorp/aws\"]","instances":[{"schema_version":2,"attributes":{"cidr_blocks":["212.117.136.162/32"],"description":"Prometheus UI to EC2","from_port":9090,"id":"sgrule-678331149","ipv6_cidr_blocks":null,"prefix_list_ids":null,"protocol":"tcp","region":"us-east-1","security_group_id":"sg-03ad9237e0de6a325","security_group_rule_id":"sgr-05ba77f22234c7745","self":false,"source_security_group_id":null,"timeouts":null,"to_port":9090,"type":"ingress"},"sensitive_attributes":[],"private":"eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjozMDAwMDAwMDAwMDB9LCJzY2hlbWFfdmVyc2lvbiI6IjIifQ==","dependencies":["data.terraform_remote_state.eks"]}]},{"mode":"managed","type":"aws_security_group_rule","name":"allow_ssh_from_your_ip","provider":"provider[\"registry.opentofu.org/hashicorp/aws\"]","instances":[{"schema_version":2,"attributes":{"cidr_blocks":["212.117.136.162/32"],"description":"SSH to EC2 (instance uses EKS node SG)","from_port":22,"id":"sgrule-1302069087","ipv6_cidr_blocks":null,"prefix_list_ids":null,"protocol":"tcp","region":"us-east-1","security_group_id":"sg-03ad9237e0de6a325","security_group_rule_id":"sgr-04061cf47cf81f975","self":false,"source_security_group_id":null,"timeouts":null,"to_port":22,"type":"ingress"},"sensitive_attributes":[],"private":"eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjozMDAwMDAwMDAwMDB9LCJzY2hlbWFfdmVyc2lvbiI6IjIifQ==","dependencies":["data.terraform_remote_state.eks"]}]},{"mode":"managed","type":"aws_volume_attachment","name":"grafana_attachment","provider":"provider[\"registry.opentofu.org/hashicorp/aws\"]","instances":[{"schema_version":0,"attributes":{"device_name":"/dev/sdg","force_detach":true,"id":"vai-2391739782","instance_id":"i-0b80143e25b6c93c6","region":"us-east-1","skip_destroy":null,"stop_instance_before_detaching":null,"timeouts":null,"volume_id":"vol-0e43aeeb064531abc"},"sensitive_attributes":[],"private":"eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjozMDAwMDAwMDAwMDAsImRlbGV0ZSI6MzAwMDAwMDAwMDAwfX0=","dependencies":["aws_ebs_volume.grafana_data","aws_instance.monitoring","data.aws_ami.amazon_linux","data.aws_subnet.public0","data.terraform_remote_state.eks"]}]},{"mode":"managed","type":"aws_volume_attachment","name":"prometheus_attachment","provider":"provider[\"registry.opentofu.org/hashicorp/aws\"]","instances":[{"schema_version":0,"attributes":{"device_name":"/dev/sdf","force_detach":true,"id":"vai-3677025209","instance_id":"i-0b80143e25b6c93c6","region":"us-east-1","skip_destroy":null,"stop_instance_before_detaching":null,"timeouts":null,"volume_id":"vol-061ec1d38f00249bc"},"sensitive_attributes":[],"private":"eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjozMDAwMDAwMDAwMDAsImRlbGV0ZSI6MzAwMDAwMDAwMDAwfX0=","dependencies":["aws_ebs_volume.prometheus_data","aws_instance.monitoring","data.aws_ami.amazon_linux","data.aws_subnet.public0","data.terraform_remote_state.eks"]}]}],"check_results":null}
